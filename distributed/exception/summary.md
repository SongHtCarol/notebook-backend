# 服务异常

- [服务异常](#服务异常)
    - [宕机](#宕机)
    - [网络异常](#网络异常)
    - [分布式系统的三态](#分布式系统的三态)
    - [存储数据丢失](#存储数据丢失)
    - [无法归类的异常](#无法归类的异常)
    - [异常处理原则](#异常处理原则)

---

### 宕机
节点无法进入正常的工作状态，不可用。（死机、卡死、处理完某个步骤后不再继续执行后续步骤）。需要机器重启，重启后将失去所有的内存信息。节点可以通过读取本地存储设备中的信息或者读取其他节点数据的方式，恢复内存信息。

### 网络异常
- 消息丢失：重试
- 消息乱序
- 数据错误：比特错误，校验码机制
- “不可靠”的TCP：在分布式系统的协议设计中不能认为所有网络通信都基于 TCP 协议则通信就是可靠的。
  - TCP 协议保证了 TCP 协议栈之间的可靠的传输，但无法保证两个上层应用之间的可靠通信
  - 由于接收方的TCP 协议栈发送的确认数据包始终被丢失，发送方的TCP 协议栈也有可能告知发送进程发送失败

### 分布式系统的三态
- 成功
- 失败
- 超时（未知）

### 存储数据丢失
指节点存储的数据不可被读取或读取出的数据错误

### 无法归类的异常
磁盘故障会导致 IO 操作缓慢，从而有可能使得进程运行速度非常慢，“缓慢”是异常吗？
网络发生严重拥塞时约等于网络不通，过一会儿又恢复，恢复后又拥塞，如此交替。

### 异常处理原则
任何在设计阶段考虑到的异常情况一定会在系统实际运行中发生，但在系统实际运行遇到的异常却很有可能在设计时未能考虑，所以，除非需求指标允许，在系统设计时不能放过任何异常情况。
